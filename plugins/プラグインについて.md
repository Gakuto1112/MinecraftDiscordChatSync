# プラグインについて
このディレクトリには、アプリケーションのプラグインが保存されています。デフォルトで保存されているプラグインは以下の通りです。

| ファイル名 | 説明 |
| --- | --- |
| Advancements.ts | 進捗達成時にボットがメッセージを送信します。 |
| Death.ts | プレイヤー死亡時にボットがメッセージを送信します。 |
| DiscordMessage.ts | Discordのメッセージをゲーム内に表示します。 |
| PlayerJoin.ts | プレイヤー参加時にボットがメッセージを送信します。 |
| PlayerLeave.ts | プレイヤー退出時にボットがメッセージを送信します。 |
| PlayerMessage.ts | プレイヤーがゲーム内でチャットを行った時にボットがメッセージを送信します。 |
| **PluginBase.ts** | プラグインの抽象クラス |
| **RconStart.ts** | Rconを接続します。 |
| ServerStart.ts | サーバー起動時にボットがメッセージを送信します。 |
| ServerStop.ts | サーバー停止時にボットがメッセージを送信します。 |

不要なプラグインはファイルを削除することで削除できます。 **太字のファイルは削除しないで下さい。** アプリケーションが正常に動作しなくなります。

## プラグインの作成について（コードが書ける人向け）
Typescriptで記述することで、ご自身でプラグインを作成できます。以下、サンプルコードです。
```typescript
import { PluginBase } from "./PluginBase";
import * as main from "../MinecraftDiscordChatSync";
import { Message } from "discord.js";

export class Plugin extends PluginBase {
	public onMinecraftMessage(time: Date, thread: string, messageType: string, message: string): void {
		if(/^\w{2,16} joined the game/.test(message)) {
			main.sendMessageToDiscord("ハロー、" + message.split(" ")[0] + "！"); // -> ハロー、<PlayerName>！
		}
	}
	public onDiscordMessage(message: Message<boolean>): void {
		main.sendRconCommand(message.member.displayName + "が何か話したぞ！"); // -> <UserName>が何か話したぞ！
	}
}
```
プラグインのコードは、 **「PluginBase」を継承して下さい。** 継承しないとエラーが出る場合があります。また、このファイルには、 **プラグイン以外のファイルを置かないようにしてください。** （Typescriptコード以外は無視されますが。）

### メソッド

#### onMinecraftMessage
```typescript
public onMinecraftMessage(time: Date, thread: string, messageType: string, message: string): void { }
```
マインクラフトでログが更新された際に呼び出されるメソッドです。  

**引数**

| 名前 | 型 | 説明 |
| --- | --- | --- |
| time | Date | ログが追記された日時 |
| thread | string | スレッド名 |
| messageType | string | メッセージの種類（INFO/WARN/ERROR/FATALなど） |
| message | string | ログ本体 |

**戻り値**  
なし

#### onDiscordMessage
```typescript
public onDiscordMessage(message: Message<boolean>): void { }
```
Discordで監視チャンネルでメッセージが送信された時に呼び出されるメソッドです。  

**引数**

| 名前 | 型 | 説明 |
| --- | --- | --- |
| message | Message | 送信されたメッセージのdiscord.jsのMessageクラス。詳しくは、[discord.jsのドキュメント](https://discord.js.org/#/docs/main/stable/class/Message)をご覧ください。 |

**戻り値**  
なし
